\
<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Feeling Family</title>

  <style>
    :root {
      /* === Palet Merah === */
      --bg:#FFFFFF;
      --text:#222222;
      --muted:#666666;
      --accent:#D21F3C;   /* merah utama */
      --accent2:#F75353;  /* merah cerah */
      --accent3:#C33F3F;  /* merah gelap */
      --border:#dcdcdc;
      --card:#f9f9f9;
      --thead:#f5f5f5;
      --neutral:#efefef;

      --warn:#f59e0b;     /* emas untuk badge #1 */
      --silver:#9ca3af;   /* perak untuk badge #2 */
      --violet:#a855f7;   /* ungu untuk badge #3 */
    }

    html, body { height: 100%; }
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, sans-serif;
      background: var(--bg);
      color: var(--text);
    }

    .container{ max-width:1120px; margin:40px auto; padding:0 16px; min-width:0; }

    header h1{
      margin:0 0 8px;
      font-weight:800;
      font-size:clamp(24px,4vw,36px);
      letter-spacing:-.02em;
      background:linear-gradient(90deg, var(--accent), var(--accent2));
      -webkit-background-clip:text; background-clip:text; color:transparent;
    }
    header p{ margin:0 0 18px; color:var(--muted); }

    /* ===== Controls ===== */
    .controls{
      display:grid; grid-template-columns:1fr auto auto; gap:10px; margin-bottom:16px; align-items:center;
    }
    .controls input, .controls select{
      background:#fff; color:var(--text);
      border:1px solid var(--accent3); border-radius:10px; padding:10px 12px; outline:none;
    }
    .controls input::placeholder{ color:#888; }
    .btn{
      border-radius:10px; padding:10px 14px; cursor:pointer; font-weight:700;
    }
    .btn-primary{
      color:#fff; border:none;
      background:linear-gradient(90deg, var(--accent), var(--accent2));
    }
    .btn-primary:hover{ filter:brightness(0.96); }

    /* ===== Stat Tiles (Total Member & Rata-rata Poin) ===== */
    .stats{
      display:grid; grid-template-columns: repeat(2, 1fr); gap:12px; margin: 12px 0 16px;
    }
    .stat-card{
      background:#fff; border:1px solid var(--border); border-radius:14px; padding:16px;
      box-shadow:0 6px 16px rgba(0,0,0,.06);
    }
    .stat-title{ color:#8a8a8a; margin:0 0 6px; font-size:.95rem; }
    .stat-value{ font-weight:800; font-size:1.4rem; margin:0; }
    .stat-bar{
      margin-top:10px; width:100%; height:10px; border-radius:999px; background:#ffdfe3; overflow:hidden;
      border:1px solid #ffccd2;
    }
    .stat-bar .fill{
      height:100%; background:linear-gradient(90deg, var(--accent), var(--accent2));
      width:0%;
      transition: width .6s ease;
    }

    /* ===== Panel Info Hasil Pencarian (single item) ===== */
    .search-info{
      margin: 6px 0 12px;
      padding: 12px;
      border: 1px solid var(--accent3);
      border-radius: 12px;
      background: linear-gradient(180deg, #fff 0%, #ffecee 100%);
      color: var(--text);
      box-shadow: 0 8px 18px rgba(0,0,0,.06);
      display:none; /* default hidden, shown on search */
    }
    .search-item{
      display: grid;
      grid-template-columns: 100px 1fr 140px 180px; /* Rank | Nama & No | Point | Gap ke #1 */
      gap: 8px;
      padding: 8px 10px;
      border: 1px solid var(--border);
      border-radius: 10px;
      background: #fff;
      align-items: center;
    }
    .search-item .rank{ font-weight: 800; color: var(--accent3); }
    .search-item .name{ font-weight: 700; }
    .search-item .member{ color: var(--muted); font-weight: 600; }
    .search-item .points,
    .search-item .gap{
      font-variant-numeric: tabular-nums;
      font-feature-settings: "tnum";
    }
    .search-item .gap{ color: var(--accent); font-weight: 700; }
    @media (max-width: 900px){
      .search-item{ grid-template-columns: 90px 1fr; }
      .search-item .points,
      .search-item .gap{ margin-top: 6px; }
      .stats{ grid-template-columns: 1fr; }
      .controls{ grid-template-columns: 1fr; }
    }

    /* ===== Podium (FIXED RESPONSIVE) ===== */
    .podium {
      margin: 12px 0 20px;
      padding: 16px;
      border-radius: 16px;
      background: linear-gradient(180deg, #fff 0%, #fafafa 100%);
      border: 1px solid var(--neutral);
    }
    /* Grid areas: kunci urutan 2‚Äì1‚Äì3 */
    .podium-wrap {
      display: grid;
      gap: 14px;
      grid-template-columns: 1fr 1.2fr 1fr;      /* 2 | 1 (lebih besar) | 3 */
      grid-template-areas: "second first third"; /* urutan tetap */
      align-items: stretch;
      min-width: 0;                               /* cegah overflow horizontal */
    }
    /* mapping area ke kartu */
    .podium-card.first  { grid-area: first; }
    .podium-card.second { grid-area: second; }
    .podium-card.third  { grid-area: third; }

    /* Kartu podium */
    .podium-card {
      position: relative;
      background: #ffffff;
      border: 1px solid var(--neutral);
      border-radius: 16px;
      padding: 16px;
      text-align: center;
      box-shadow: 0 8px 24px rgba(0,0,0,.06);
      min-width: 0; /* IZINKAN shrink di dalam grid */
    }
    /* Background aksen merah per posisi */
    .podium-card.first::before,
    .podium-card.second::before,
    .podium-card.third::before{
      content:""; position:absolute; inset:-1px; border-radius:16px; z-index:-1;
      background: radial-gradient(600px 220px at 50% -20%, rgba(210,31,60,.15), rgba(247,83,83,.06) 70%);
    }
    .podium-card.second::before{
      background: radial-gradient(600px 220px at 50% -20%, rgba(195,63,63,.18), rgba(247,83,83,.08) 70%);
    }
    .podium-card.third::before{
      background: radial-gradient(600px 220px at 50% -20%, rgba(247,83,83,.18), rgba(210,31,60,.08) 70%);
    }

    .podium-card .podium-avatar {
      width: 84px; height: 84px; margin: 0 auto 10px; border-radius: 12px;
      background: linear-gradient(135deg, #ffd1d8, var(--accent) 60%, var(--accent2));
      border: 1px solid #ffd6dc;
      max-width: 100%;
    }
    .podium-card .podium-name { margin: 6px 0 2px; font-weight: 700; }
    .podium-card .podium-member { margin: 0 0 10px; color: var(--muted); font-size: 0.95rem; }
    .podium-card .podium-trophy {
      display: inline-flex; align-items: center; gap: 8px;
      padding: 8px 12px; border-radius: 999px;
      background: #fff; border: 1px solid var(--neutral); color: var(--text);
    }
    .trophy-icon { font-size: 1.1rem; }

    .podium-card.first {
      transform: translateY(-8px);
      background: #fff;
      border: 1px solid var(--neutral);
      box-shadow: 0 10px 28px rgba(0,0,0,.08);
    }
    .podium-card.first .podium-avatar {
      width: 96px; height: 96px;
      background: linear-gradient(135deg, #ffe9cc, #f59e0b 60%, #f97316);
      border-color: #ffe1b8;
    }
    .podium-card .podium-badge {
      position: absolute; top: -10px; right: -10px;
      background: linear-gradient(90deg,#f59e0b,#f97316);
      color: #fff; font-weight: 800; padding: 8px 12px; border-radius: 999px;
      border: 1px solid #f59e0b;
      box-shadow: 0 2px 6px rgba(0,0,0,.15);
    }
    .podium-card.second .podium-badge {
      background: linear-gradient(90deg,#9ca3af,#d1d5db); /* silver gradient */
      color: #1f2937; /* abu gelap agar kontras */
      border: 1px solid #9ca3af;
    }
    .podium-card.third .podium-badge {
      background: linear-gradient(90deg,#a855f7,#c084fc); /* violet gradient */
      color: #ffffff;
      border: 1px solid #a855f7;
    }

    .podium-meta {
      margin-top: 10px;
      color: var(--muted);
      font-size: 0.95rem;
      text-align: center;
    }

    /* Mobile (‚â§640px): satu kolom, urutan tetap 2 ‚Üí 1 ‚Üí 3 */
    @media (max-width: 640px) {
      .podium-wrap {
        grid-template-columns: 1fr;
        grid-template-areas:
          "second"
          "first"
          "third";
      }
      .podium-card { padding: 14px; }
      .podium-card.first { transform: translateY(0); }
      .podium-card .podium-badge { top: -8px; right: 8px; }
    }

    /* Tablet (641‚Äì900px): tetap 3 kolom 2‚Äì1‚Äì3 */
    @media (min-width: 641px) and (max-width: 900px) {
      .podium-wrap {
        grid-template-columns: 1fr 1.2fr 1fr;
        grid-template-areas: "second first third";
      }
    }

    /* ===== Table ===== */
    .card{
      background:var(--card);
      border:1px solid var(--neutral);
      border-radius:14px; overflow:hidden;
      box-shadow:0 8px 24px rgba(0,0,0,.06);
    }
    .table-accent{ height:6px; background:linear-gradient(90deg, var(--accent), var(--accent2)); }
    table{ width:100%; border-collapse:collapse; }
    thead th{
      text-align:left; font-weight:700; padding:12px 14px;
      background:var(--thead); border-bottom:1px solid var(--neutral);
      position:sticky; top:0; z-index:1; color:#333;
    }
    tbody td{ padding:12px 14px; border-bottom:1px solid var(--neutral); }
    tbody tr:nth-child(odd){ background:#fff; }
    tbody tr:nth-child(even){ background:#fcfcfc; }

    .rank-badge{
      display:inline-block; min-width:36px; text-align:center;
      padding:6px 10px; border-radius:999px; font-weight:700;
      color:#ffffff;
      background: var(--accent); /* default badge */
      border: 1px solid var(--accent3);
    }
    .mono{ font-variant-numeric:tabular-nums; font-feature-settings:"tnum"; }
    .footer{ color:var(--muted); font-size:12px; padding:12px; text-align:right; }
    .empty{ padding:24px; text-align:center; color:#777; }

    a { color: var(--accent); }
    :focus-visible { outline: 2px solid var(--accent2); outline-offset: 2px; }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>Feeling Leaderboard</h1>
      <p>Data diambil dari Google Sheets (kolom: <strong>No Member</strong>, <strong>Nama</strong>, <strong>Point</strong>).</p>
    </header>

    <!-- Kontrol -->
    <div class="controls" role="region" aria-label="Filter dan aksi">
      <input id="searchBox" type="search" placeholder="Cari nama atau No Member‚Ä¶" aria-label="Cari" />
      <select id="limitSelect" aria-label="Tampilkan">
        <option value="10" selected>Top 10</option>
        <option value="25">Top 25</option>
        <option value="50">Top 50</option>
        <option value="0">Semua</option>
      </select>
      <button id="refreshBtn" class="btn btn-primary" aria-label="Muat ulang data">Muat Ulang</button>
    </div>

    <!-- Stat Tiles -->
    <section class="stats" aria-label="Ringkasan">
      <article class="stat-card">
        <p class="stat-title">Total Member</p>
        <h3 class="stat-value" id="statTotal">0</h3>
        <div class="stat-bar"><div class="fill" id="barTotal" style="width:0%"></div></div>
      </article>
      <article class="stat-card">
        <p class="stat-title">Rata-rata Poin</p>
        <h3 class="stat-value" id="statAvg">0</h3>
        <div class="stat-bar"><div class="fill" id="barAvg" style="width:0%"></div></div>
      </article>
    </section>

    <!-- Panel Info Hasil Pencarian (single item) -->
    <div id="searchInfo" class="search-info" aria-live="polite"></div>

    <!-- Podium 3 teratas -->
    <section class="podium" aria-label="Klasemen 3 teratas">
      <div class="podium-wrap">
        <!-- Juara 2 -->
        <article class="podium-card second" id="rank-2">
          <div class="podium-avatar" aria-hidden="true"></div>
          <h3 class="podium-name" id="podium2-name">‚Äî</h3>
          <p class="podium-member" id="podium2-member">‚Äî</p>
          <div class="podium-trophy">
            <span class="trophy-icon">üèÜ</span> <span id="podium2-point">0</span> poin
          </div>
          <div class="podium-badge">#2</div>
        </article>

        <!-- Juara 1 -->
        <article class="podium-card first" id="rank-1">
          <div class="podium-avatar" aria-hidden="true"></div>
          <h3 class="podium-name" id="podium1-name">‚Äî</h3>
          <p class="podium-member" id="podium1-member">‚Äî</p>
          <div class="podium-trophy">
            <span class="trophy-icon">üèÜ</span> <span id="podium1-point">0</span> poin
          </div>
          <div class="podium-badge">#1</div>
        </article>

        <!-- Juara 3 -->
        <article class="podium-card third" id="rank-3">
          <div class="podium-avatar" aria-hidden="true"></div>
          <h3 class="podium-name" id="podium3-name">‚Äî</h3>
          <p class="podium-member" id="podium3-member">‚Äî</p>
          <div class="podium-trophy">
            <span class="trophy-icon">üèÜ</span> <span id="podium3-point">0</span> poin
          </div>
          <div class="podium-badge">#3</div>
        </article>
      </div>
      <div class="podium-meta" id="podiumMeta" aria-live="polite"></div>
    </section>

    <!-- Tabel -->
    <div class="card" role="region" aria-label="Tabel leaderboard">
      <div class="table-accent" aria-hidden="true"></div>
      <table id="board">
        <thead>
          <tr>
            <th style="width:90px">Peringkat</th>
            <th style="width:140px">No Member</th>
            <th>Nama</th>
            <th style="width:140px">Point</th>
          </tr>
        </thead>
        <tbody id="boardBody">
          <tr><td colspan="4" class="empty">Memuat data‚Ä¶</td></tr>
        </tbody>
      </table>
      <div class="footer" id="meta" aria-live="polite"></div>
    </div>
  </div>

  <script>
    // ===== KONFIGURASI: Sheet kamu =====
    const SHEET_ID = "1UBrdYls_Ed0GIXCSPghK9C3du5dEhbdx"; // ganti jika perlu
    const GID      = "371192175";                           // ganti jika perlu
    const HEADERS_EXPECT = ["No Member","Nama","Point"];

    // Endpoints
    const GVIZ_URL = (id,gid)=>`https://docs.google.com/spreadsheets/d/${id}/gviz/tq?tqx=out:json&gid=${gid}`;
    const CSV_URL  = (id,gid)=>`https://docs.google.com/spreadsheets/d/${id}/export?format=csv&gid=${gid}`;

    // State
    const state = { rows: [], filtered: [], limit: 10, query: "", rankMap: {} };

    const el = {
      body: document.getElementById("boardBody"),
      meta: document.getElementById("meta"),
      search: document.getElementById("searchBox"),
      limit: document.getElementById("limitSelect"),
      refresh: document.getElementById("refreshBtn"),
      info: document.getElementById("searchInfo"),
      statTotal: document.getElementById("statTotal"),
      statAvg: document.getElementById("statAvg"),
      barTotal: document.getElementById("barTotal"),
      barAvg: document.getElementById("barAvg"),
    };

    // ===== Fetch main =====
    async function fetchSheet(){
      el.body.innerHTML = `<tr><td colspan="4" class="empty">Memuat data‚Ä¶</td></tr>`;

      // Coba GVIZ
      if (await tryFetchGviz()) return;
      // Fallback CSV
      if (await tryFetchCsv()) return;

      el.body.innerHTML = `<tr><td colspan="4" class="empty">
        Gagal memuat data. Pastikan Sheet dibagikan publik dan sudah <b>Publish to the web</b>.
      </td></tr>`;
      el.meta.textContent = `Fetch gagal ‚Ä¢ ${new Date().toLocaleString("id-ID")}`;
    }

    async function tryFetchGviz(){
      try{
        const res = await fetch(GVIZ_URL(SHEET_ID, GID), { cache: "no-store" });
        const text = await res.text();
        const jsonStr = text.replace(/^[^(]+\(/,"").replace(/\)\s*;?\s*$/,"");
        const payload = JSON.parse(jsonStr);
        if (!payload.table) throw new Error("payload.table kosong");

        const headers = payload.table.cols.map(c => (c.label || "").trim());
        const rows = payload.table.rows.map(r => {
          const c = r.c || []; const o = {};
          headers.forEach((label,i)=>{ o[label] = c[i]?.v ?? ""; });
          return o;
        });

        applyAndRender(rows, headers, "Google Visualization (JSON)");
        return true;
      }catch(e){ console.warn("GVIZ gagal:", e); return false; }
    }

    async function tryFetchCsv(){
      try{
        const res = await fetch(CSV_URL(SHEET_ID, GID), { cache: "no-store" });
        const csv = await res.text();
        const { headers, rows } = parseCsv(csv);
        applyAndRender(rows, headers, "CSV export");
        return true;
      }catch(e){ console.warn("CSV gagal:", e); return false; }
    }

    function parseCsv(text){
      const lines = text.trim().split(/\r?\n/);
      const headers = splitCsvLine(lines[0]).map(h=>h.trim());
      const rows = lines.slice(1).map(line=>{
        const cols = splitCsvLine(line);
        const o={}; headers.forEach((h,i)=>{ o[h]=(cols[i]??"").trim(); });
        return o;
      });
      return { headers, rows };
    }
    function splitCsvLine(line){
      const out=[]; let cur="", q=false;
      for(let i=0;i<line.length;i++){
        const ch=line[i];
        if(ch=='"'){ if(q && line[i+1]=='"'){cur+='"'; i++;} else { q=!q; } }
        else if(ch==',' && !q){ out.push(cur); cur=""; }
        else { cur+=ch; }
      }
      out.push(cur); return out;
    }

    function normalizeHeaderMap(headers, expected){
      const lower=headers.map(h=>h.toLowerCase()); const map={};
      expected.forEach(exp=>{ const idx=lower.indexOf(exp.toLowerCase()); if(idx>=0) map[exp]=headers[idx]; });
      return map;
    }

    // ===== Apply & Render with GLOBAL RANK =====
    function applyAndRender(rows, headers, source){
      const map = normalizeHeaderMap(headers, HEADERS_EXPECT);

      // Normalisasi data ke kolom yang kita pakai
      const data = rows.map(r=>({
        "No Member": r[map["No Member"]] ?? r["No Member"] ?? "",
        "Nama":      r[map["Nama"]]      ?? r["Nama"]      ?? "",
        "Point":     r[map["Point"]]     ?? r["Point"]     ?? 0
      }));

      // Sortir desc berdasarkan Point
      data.sort((a,b)=>Number(b["Point"]) - Number(a["Point"]));

      // Peta rank global (No Member -> rank 1-based)
      const rankMap = {};
      data.forEach((row, i) => {
        const key = String(row["No Member"] ?? "").trim();
        if (key) rankMap[key] = i + 1;
      });

      state.rows = data;
      state.rankMap = rankMap;

      // Render podium 3 teratas
      renderPodium(state.rows);

      // Update stat tiles (Total & Avg)
      updateStats();

      applyFilter();
      render();
      el.meta.textContent = `Sumber: ${source} ‚Ä¢ ${state.filtered.length} baris ‚Ä¢ ${new Date().toLocaleString("id-ID")}`;
    }

    function applyFilter(){
      const q = state.query.trim().toLowerCase();
      state.filtered = !q
        ? [...state.rows]
        : state.rows.filter(r =>
            String(r["No Member"]).toLowerCase().includes(q) ||
            String(r["Nama"]).toLowerCase().includes(q)
          );
    }

    function rankBadge(rank){
      const styles=[
        "background:linear-gradient(90deg,#f59e0b,#f97316);color:#ffffff;", // 1
        "background:linear-gradient(90deg,#9ca3af,#d1d5db);color:#333333;", // 2
        "background:linear-gradient(90deg,#a855f7,#c084fc);color:#ffffff;"  // 3
      ];
      const style=styles[rank-1]||`background:${getComputedStyle(document.documentElement).getPropertyValue('--accent')};color:#ffffff;border:1px solid var(--accent3);`;
      return `<span class="rank-badge" style="${style}">${rank}</span>`;
    }

    // ===== Render tabel + Panel info hasil pencarian (single item) =====
    function render(){
      const isSearching = !!state.query.trim();

      // Nilai poin peringkat #1 untuk menghitung gap
      const top1Points = Number(state.rows[0]?.["Point"] ?? 0);

      // Panel Info: hanya tampilkan item pertama dari hasil pencarian
      if (isSearching){
        if (state.filtered.length === 0){
          el.info.style.display = "none";
          el.info.innerHTML = "";
        } else {
          const r    = state.filtered[0];
          const no   = String(r["No Member"] ?? "").trim();
          const nama = String(r["Nama"] ?? "").trim();
          const pts  = Number(r["Point"] ?? 0);
          const rank = state.rankMap[no] ?? "-";
          const gap  = Math.max(top1Points - pts, 0);

          el.info.innerHTML = `
            <div style="font-weight:700; margin-bottom:8px;">
              Hasil utama untuk: "<span style="color:var(--accent3)">${state.query.trim()}</span>"
            </div>
            <div class="search-item">
              <div class="rank">#${rank}</div>
              <div>
                <div class="name">${nama}</div>
                <div class="member">${no}</div>
              </div>
              <div class="points"><b>${pts.toLocaleString("id-ID")}</b> poin</div>
              <div class="gap">Selisih ke #1: <b>${gap.toLocaleString("id-ID")}</b> poin</div>
            </div>
          `;
          el.info.style.display = "block";
        }
      } else {
        el.info.style.display = "none";
        el.info.innerHTML = "";
      }

      // TABEL: jika mencari tampilkan dari index 0; jika tidak, buang top-3 (karena sudah di podium)
      const startIndex = isSearching ? 0 : Math.min(3, state.filtered.length);
      const remaining  = Math.max(state.filtered.length - startIndex, 0);
      const limit      = state.limit === 0 ? remaining : Math.min(state.limit, remaining);
      const slice      = state.filtered.slice(startIndex, startIndex + limit);

      if (slice.length===0){
        el.body.innerHTML = `<tr><td colspan="4" class="empty">Tidak ada data.</td></tr>`;
        return;
      }

      const rowsHtml = slice.map((r) => {
        const key   = String(r["No Member"] ?? "").trim();
        const rank  = state.rankMap[key] ?? "-";
        const point = Number(r["Point"] ?? 0).toLocaleString("id-ID");
        return `
          <tr>
            <td>${rankBadge(rank)}</td>
            <td class="mono">${r["No Member"] ?? ""}</td>
            <td>${r["Nama"] ?? ""}</td>
            <td class="mono"><b>${point}</b></td>
          </tr>
        `;
      }).join("");

      el.body.innerHTML = rowsHtml;
    }

    function renderPodium(sortedRows){
      const top3 = (sortedRows || state.rows).slice(0, 3);
      const p1 = top3[0] || { "Nama":"‚Äî", "No Member":"‚Äî", "Point":0 };
      const p2 = top3[1] || { "Nama":"‚Äî", "No Member":"‚Äî", "Point":0 };
      const p3 = top3[2] || { "Nama":"‚Äî", "No Member":"‚Äî", "Point":0 };

      const set = (id, text) => { const e = document.getElementById(id); if (e) e.textContent = text; };

      set("podium1-name",   String(p1["Nama"]));
      set("podium1-member", String(p1["No Member"]));
      set("podium1-point",  Number(p1["Point"]||0).toLocaleString("id-ID"));

      set("podium2-name",   String(p2["Nama"]));
      set("podium2-member", String(p2["No Member"]));
      set("podium2-point",  Number(p2["Point"]||0).toLocaleString("id-ID"));

      set("podium3-name",   String(p3["Nama"]));
      set("podium3-member", String(p3["No Member"]));
      set("podium3-point",  Number(p3["Point"]||0).toLocaleString("id-ID"));

      const meta = document.getElementById("podiumMeta");
      if (meta) meta.textContent = `Teratas saat ini ‚Ä¢ diperbarui ${new Date().toLocaleString("id-ID")}`;
    }

    // ===== Stat Tiles logic =====
    function updateStats(){
      const total = state.rows.length;
      const sumPts = state.rows.reduce((s,r)=> s + Number(r["Point"]||0), 0);
      const avg   = total ? (sumPts / total) : 0;

      el.statTotal.textContent = total.toLocaleString("id-ID");
      el.statAvg.textContent   = Math.round(avg).toLocaleString("id-ID");

      // Progress bar:
      // - Total: asumsi target 100 member ‚Üí width = total/100
      // - Avg   : asumsi target 5000 poin ‚Üí width = avg/5000
      el.barTotal.style.width = Math.min(100, (total/100)*100) + "%";
      el.barAvg.style.width   = Math.min(100, (avg/5000)*100) + "%";
    }

    // Events
    el.search.addEventListener("input",(e)=>{ state.query=e.target.value; applyFilter(); render(); });
    el.limit.addEventListener("change",(e)=>{ state.limit=Number(e.target.value); render(); });
    el.refresh.addEventListener("click",()=>{ fetchSheet(); });

    // Init
    fetchSheet();
  </script>
</body>
</html>
